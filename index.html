<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>betterCam - SwiftUI Style Layout</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #000; color: white; }
        .viewport { width: 100vw; height: 100vh; position: relative; touch-action: none; }
        .slide-container { width: 100%; height: 100%; will-change: transform; }
        .is-animating { transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1); }
        .section { width: 100vw; height: 100vh; position: relative; }
    </style>
</head>
<body>

<div id="app">
    <div class="viewport"
         @touchstart="handleTouchStart" @touchmove="handleTouchMove" @touchend="handleTouchEnd" @wheel="handleWheel">

        <div class="slide-container" :class="{ 'is-animating': isAnimating }" :style="{ transform: `translateY(${currentTranslateY}px)` }">

            <section class="section flex flex-col items-center justify-center bg-zinc-900">
                <h1 class="text-4xl font-bold mb-4">betterCam</h1>
                <p class="text-zinc-500">在iPhone上找回摄影的仪式感</p>
            </section>

            <section class="section bg-black p-12 md:p-24">
                <div class="flex flex-col items-start justify-start h-full">

                    <h2 class="text-6xl md:text-8xl font-bold mb-8 tracking-tighter">
                        重构操作体验
                    </h2>

                    <p class="text-zinc-400 text-xl md:text-2xl leading-relaxed max-w-lg tracking-wide">
                        仿物理拨轮，如真机一般的触觉反馈。
                    </p>

                    <img src="dial_shutter.jpg" />

                    <div class="flex-grow"></div>
                </div>
                <div class="flex flex-grow h-full">

                </div>
            </section>

            <section class="section bg-black p-12 md:p-24">
                <div class="flex flex-col items-start justify-start h-full">

                    <h2 class="text-6xl md:text-8xl font-bold mb-8 tracking-tighter">
                        参数一应俱全
                    </h2>

                    <p class="text-zinc-400 text-xl md:text-2xl leading-relaxed max-w-lg tracking-wide">
                        上下参数条，符合相机操作逻辑且触手可及。
                    </p>

                    <div class="flex-grow"></div>
                </div>
            </section>

            <section class="section bg-black p-12 md:p-24">
                <div class="flex flex-col items-start justify-start h-full">

                    <h2 class="text-6xl md:text-8xl font-bold mb-8 tracking-tighter">
                        专业功能满载
                    </h2>

                    <p class="text-zinc-400 text-xl md:text-2xl leading-relaxed max-w-lg tracking-wide">
                        波形图、直方图，实现准确曝光；AF-S模式，实现更符合摄影者意图的对焦。
                    </p>

                    <div class="flex-grow"></div>
                </div>
            </section>

            <section class="section bg-black p-12 md:p-24">
                <div class="flex flex-col items-start justify-start h-full">

                    <h2 class="text-6xl md:text-8xl font-bold mb-8 tracking-tighter">
                        创意不设限
                    </h2>

                    <p class="text-zinc-400 text-xl md:text-2xl leading-relaxed max-w-lg tracking-wide">
                        内置多种预设和四种胶片模拟，更可导入自定义LUT，实现更多色彩风格。
                    </p>

                    <div class="flex-grow"></div>
                </div>
            </section>

        </div>
    </div>
</div>

<script>
  const { createApp, ref, onMounted } = Vue;
  createApp({
    setup() {
      const activeIndex = ref(0);
      // 【关键修复 1】：将 3 改为 5，或者直接动态获取
      // 如果你以后还会增加页面，建议用 document.querySelectorAll('.section').length
      const totalSections = 5;

      const windowHeight = ref(window.innerHeight);
      const currentTranslateY = ref(0);
      const isAnimating = ref(false);
      let startY = 0;
      let lastTranslateY = 0;

      onMounted(() => {
        window.addEventListener('resize', () => {
          windowHeight.value = window.innerHeight;
          currentTranslateY.value = -activeIndex.value * windowHeight.value;
          lastTranslateY = currentTranslateY.value;
        });
      });

      const handleTouchStart = (e) => {
        if (isAnimating.value) return;
        startY = e.touches[0].clientY;
        isAnimating.value = false;
      };

      const handleTouchMove = (e) => {
        if (isAnimating.value) return;
        const deltaY = e.touches[0].clientY - startY;
        let nextY = lastTranslateY + deltaY;

        // 【关键修复 2】：这里的判断逻辑依赖上面的 totalSections
        if (nextY > 0 || nextY < -(totalSections - 1) * windowHeight.value) {
          nextY = lastTranslateY + deltaY * 0.3;
        }
        currentTranslateY.value = nextY;
      };

      const handleTouchEnd = () => {
        isAnimating.value = true;
        const progress = -currentTranslateY.value / windowHeight.value;
        // 【关键修复 3】：targetIndex 的上限也依赖 totalSections
        const targetIndex = Math.max(0, Math.min(totalSections - 1, Math.round(progress)));
        snapTo(targetIndex);
      };

      const handleWheel = (e) => {
        if (isAnimating.value || Math.abs(e.deltaY) < 10) return;
        isAnimating.value = true;
        // 【关键修复 4】：滚轮逻辑的边界检查
        if (e.deltaY > 0 && activeIndex.value < totalSections - 1) activeIndex.value++;
        else if (e.deltaY < 0 && activeIndex.value > 0) activeIndex.value--;
        snapTo(activeIndex.value);
      };

      const snapTo = (index) => {
        activeIndex.value = index;
        currentTranslateY.value = -index * windowHeight.value;
        lastTranslateY = currentTranslateY.value;
        setTimeout(() => { isAnimating.value = false; }, 600);
      };

      return { currentTranslateY, isAnimating, handleTouchStart, handleTouchMove, handleTouchEnd, handleWheel };
    }
  }).mount('#app');
</script>
</body>
</html>